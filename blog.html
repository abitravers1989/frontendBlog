<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, inital-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Gaegu" rel="stylesheet">
  <title>Abi Travers Blog</title>  
  <!-- link is a link to an external resource. -->
  <link rel="stylesheet" href="reset.css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
  <link rel="stylesheet" href="blog.css">
  <link rel="icon" href="https://antoni.de/wp-content/themes/antoni/favicon.png">
  
</head>
<style>

    :root {
    --lightgrey: #F7F7F7;
    --darkblue: #00151C;
    --blue: #002C4C;
    --midblue: #17A6D6;
    --lighblue: #17A6D6;
    }

    .top-padding{
        display: grid;
        height: 20px;
    }

    nav{
        background-color: white;
        height: 70px;
    }
    .navigation{
        /* background-color: white; */
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        list-style: none;
        grid-auto-rows: minmax(70px, auto);             
    }

    .navigation > li {
        display: grid;
        align-self: center;
        /* justify-self: center; */
       
        font-family: 'Montserrat', sans-serif;
        font-style: italic;
        font-weight: 1000;
        font-size: 2rem;
        text-decoration: none;
        margin-left: 8px;
        /* justify-content: left 70px; */
        
    }

    .nav-link{
        text-decoration: none;
        color: var(--darkblue);
    }

    .box{
        width: 80px;
        height: 80px;
        background-color: aqua;
        transition: width 0.3s, height 0.3s;
        /* transition-property: width;
        transition-duration: 2s;
        transition-property: height;
        transition-duration: 2s; */
        transition-timing-function: linear;
    }

    .box:hover{
        width: 300px;
        height: 300px;
    }

     .box2{
        width: 80px;
        height: 80px;
        background-color:white;
       
    }

/* here make it fill a few more grib columns .. change the space it occupies  */
    .boxChange {
        background-color: black; 
        margin: 4%;
        padding: 10%;
        width: 90%;
        height: 600px;
        color: white;
    /* margin: 25%; */
    }

</style>

<body>
    <div class="container content-wrap" id="page-container">


            <div class="top-padding"></div>
            <nav>
                <!-- ID should be unique something you will only have one of
                classes are the things that you should use to identify elements.
                non-unquie ids may throw errors  -->
                <ul class="navigation">
                    <li>
                        <a class="nav-link" href="index.html"> Home </a>
                    </li>
                    <li>
                        <a class="nav-link" href="/game/game.html"> Game </a>
                    </li>
                    <li>
                        <a class="nav-link" href="/game/game.html"> Game </a>
                    </li>
                </ul>
            </nav>

            <div class="blogTitle">
                <h1>Blog Title</h1>
            </div>

            <div class="postContent"> </div>

            <div class="cloudwrapper">
                <div class="cloud"></div>
                <div class="cloud2 wrapper"></div>
                <div class="cloud3 wrapper"></div>        
            </div>

            <div class="box"> </div>

            <div class="box2"> Show Blogs 
                <ul class="showResults">

                </ul>
    
    
            </div>


    </div> 



     <script>
               
        function init(){
            addEventListener2()
           // addEventListener()
        }  


    function addEventListener(){
      //blogTitle = document.querySelector('.blogTitle');
      //blogTitle.addEventListener("mouseover", changeColor)
      const showResults = document.querySelector('.showResults');
      showResults.addEventListener("click", openPost)
    }

    function openPost(event){
        //console.log(event.target.attributes[0].value)
        event.stopPropagation();
        const postContentPlaceholder = document.querySelector('.postContent');
        //give blog ID instead of blog title
        const blogTitle = event.target.attributes[0].value
       // postContentPlaceholder.innerText = getContent(blogTitle)
        //refactor and give it ID 
        const heading = document.createElement("h2")
        heading.innerText = blogTitle

        //const content = getContent(blogTitle)

        postContentPlaceholder.appendChild(heading)
        
        let contentElement = document.createElement("p")

        fetch(`http://localhost:5000/posts/${blogTitle}`)
        .then(response => response.json())

        //fetch returns a promise not a value 
        .then(jsonResponse => { return jsonResponse.content })
        .then (jsonResponse => contentElement.innerText = jsonResponse)

        postContentPlaceholder.appendChild(contentElement)
        
    }

// when added to the event listener it changes the box2's color and size 
    function changeColor(eventObject){
      box2 = document.querySelector('.box2');
      box2.classList.add('boxChange')
    }

    fetch('http://localhost:5000/posts')
    .then(response => response.json())
    .then(jsonResponse => listBlogs(jsonResponse))
        .catch(function(error)
        {
            console.log(error)
        });

    function listBlogs(jsonData){
        const resultsSection = document.querySelector('.showResults')
        resultsSection.innerHTML = '';
        let html = '';
        jsonData.forEach(post => {
            html+=
            `<li> 
                <div data-href="${post.title}"> ${post.title}:  ${post.postTime} </div> 
             </li>`
           // http://localhost:5000/posts/${post.title}"
          // <button id="buttonID' class= "posts ${post.id}" type="button"> Show Post </button>
        });

        resultsSection.innerHTML = html;
    }

      function addEventListener2(){
      //blogTitle = document.querySelector('.blogTitle');
      //blogTitle.addEventListener("mouseover", changeColor)
      const showResults = document.querySelector('.showResults');
      showResults.addEventListener("click", goToNewPage)
    }

    function goToNewPage(e){
        console.log(e)
        event.stopPropagation();
        const blogTitle = event.target.attributes[0].value
        console.log(blogTitle)
        //const blogTitleWithoutWhiteSpace = blogTitle.replace(/\s+/g, '');

        //need to remove the %20 from it 
        window.location.href = `template.html/?${blogTitle}`
    }

        init()


        </script>

</body>


</html>